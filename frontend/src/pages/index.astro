---
import Layout from "../layouts/Layout.astro";
---

<Layout>
	<div class="container">
		<div class="top-half">
			<div class="face-container">
				<div class="icon icon-1">‚ù§Ô∏è</div>
				<div class="icon icon-2">üí¨</div>
				<div class="icon icon-3">‚≠ï</div>
				<div class="icon icon-4">‚ùå</div>
				<div class="icon icon-5">üçë</div>
				<div class="icon icon-6">üòô</div>
				<img src="openjan.png" alt="face" />
			</div>
		</div>
	</div>
	<div class="bottom-container">
		<h1>Welcome</h1>

		<form action="" method="post" id="login">
			<div class="login-container">
				<input type="text" id="login-email" placeholder="Email" />
				<input
					type="password"
					id="login-password"
					placeholder="Password"
				/>
				<button id="login-btn" type="submit">Log in</button>
				<button id="signup-btn"><a href="/register">Sign up</a></button>
			</div>
		</form>

		<!-- Log in Error -->
		<div id="error-container">
			<p id="error-message">Are You Serious?!</p>
			<img
				id="error-image"
				src="/images/img_loginError.jpg"
				alt="Login Error"
				width="200"
			/>
		</div>
	</div>
</Layout>

<script>
	const form = document.querySelector("#login") as HTMLFormElement;
	form.addEventListener("submit", async (e) => {
		e.preventDefault();
		const formData = new FormData(e.target as HTMLFormElement);
		const formObject = Object.fromEntries(formData.entries());

		const res = await fetch(`http://localhost:3500/login`, {
			method: "post",
			credentials: "include",
			headers: {
				"Content-Type": "application/json",
			},
			body: JSON.stringify(formObject),
		});

		if (res.ok) {
			window.location.href = "/profile";
		}
		const response = await res.json();
		const errorContainer = document.getElementById(
			"error-container",
		) as HTMLFormElement;
		errorContainer.style.display = "block";
	});
</script>

<style>
	/* body {
		background-color: #f6ae2b;
	}
	face {
		color: #fffdfa;
	}
	white {
		color: #ffffff;
	}
	grey {
		color: #cacacb;
	} */

	body {
		margin: 0;
		font-family: Arial, sans-serif;
		background: #fff;
	}

	#error-container {
		display: none;
		text-align: center;
		position: absolute;
	}
	#error-image {
		width: 320px;
	}
	#error-message {
		position: absolute;
		top: 10%;
		left: 20%;
		font-size: 1.5rem;
		font-weight: 700;
		color: #c33620;
	}
	.container {
		height: 50vh;
		margin-bottom: 3rem;
	}
	.top-half {
		background-color: #f6ae2b;
		width: 100%;
		height: 40vh;
		border-bottom-left-radius: 50% 20%;
		border-bottom-right-radius: 50% 20%;
		display: flex;
		flex-direction: column;
		justify-content: center;
		align-items: center;
		position: relative;
	}
	.face-container {
		position: relative;
		width: 150px;
		height: 150px;
		top: 40%;
		border-radius: 50%;
		border: solid 15px #f6ae2b;
		display: flex;
		justify-content: center;
		align-items: center;
		/* overflow: hidden; */
	}
	.face-container img {
		border-radius: 50%;
		object-fit: cover;
		width: 150px;
		height: 150px;
	}
	.icon {
		font-size: 2rem;
		position: absolute;
		left: 200px;
	}
	.icon-1 {
		top: 184px;
		left:92px;
	}
	.icon-2 {
		top: 180px;
		left:10px;
	}
	.icon-3 {
		top: 32px;
		left: -80px;
	}
	.icon-4 {
		top: 30px;
	}
	.icon-5 {
		top: 130px;
		left:150px;
	}
	.icon-6 {
		top: 130px;
		left:-70px;
	}
	.icon{
		animation: rotateOnce 0.6s ease-out forwards;
	}
	@keyframes rotateOnce {
		0% {
			transform: rotate(0deg);
		}
		50%{
			transform: rotate(170deg);
		}
		100% {
			transform: rotate(0deg);
		}
	}
	.bottom-container {
		height: 50vh;
		display: flex;
		flex-direction: column;
		align-items: center;
	}
	.login-container {
		display: flex;
		flex-direction: column;
		gap: 1rem;
	}
	button {
		border-radius: 20px;
		height: 2rem;
		font-size: 1.1rem;
		border: solid 4px #f6ae2b;
		background-color: #f6ae2b;
	}
	button:hover {
		cursor: pointer;
	}
	#login-email,
	#login-password {
		border: solid 2px #f6ae2b;
		border-radius: 10px;
		height: 1.5rem;
	}
	h1 {
		color: #f6ae2b;
	}
	a {
		text-decoration: none;
		color: inherit;
	}
	input {
		text-align: center;
	}
</style>

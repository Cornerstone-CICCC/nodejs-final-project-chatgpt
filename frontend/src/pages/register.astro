---
import Layout from "../layouts/Layout.astro";
---

<Layout>
	<div class="container">
		<div class="top-half">
			<div class="face-container">
				<img src="openjan.png" id="user-image" alt="face" />
			</div>
		</div>
	</div>
	<div class="bottom-container">
		<h1>I Am New Member</h1>

		<form action="" method="POST" id="signup">
			<div class="signup-container">
                <input type="text" id="signup-firstname" placeholder="First Name"/>
                <input type="text" id="signup-lastname" placeholder="Last Name"/>
				<input type="text" id="signup-email" placeholder="Email" />
				<input
					type="password"
					id="signup-password"
					placeholder="Password"
				/>
                <input type="url" name="image" id="url-image" placeholder="URL of your photo"/>
				<button id="signup-btn" type="submit">Sign up</button>
			</div>
		</form>
	</div>
</Layout>

<script>
    const form = document.querySelector("#signup") as HTMLFormElement;
    form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const formData = new FormData(e.target as HTMLFormElement);
        const formObject = Object.fromEntries(formData.entries());

        const res = await fetch(`http://localhost:3500/user/signup`, {
            method: "post",
            credentials: "include",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify(formObject),
        });

        if (res.ok) {
            window.location.href = "/";
        }
    });

    const imginput = document.querySelector('#url-image') as HTMLInputElement;
    const userimg = document.querySelector('#user-image') as HTMLInputElement;
    imginput.addEventListener('input', ()=>{
        const url = imginput.value.trim();
        if(url){
            userimg.src = url;
        }

    })
</script>

<style>
	body {
		margin: 0;
		font-family: Arial, sans-serif;
		background: #fff;
	}

	.container {
		height: 50vh;
	}
	.top-half {
		background-color: #f6ae2b;
		width: 100%;
		height: 40vh;
		border-bottom-left-radius: 50% 20%;
		border-bottom-right-radius: 50% 20%;
		display: flex;
		flex-direction: column;
		justify-content: center;
		align-items: center;
		position: relative;
	}
	.face-container {
		position: relative;
		width: 150px;
		height: 150px;
		background-color: #fff;
		top: 40%;
		border-radius: 50%;
		border: solid 15px #f6ae2b;
		display: flex;
		justify-content: center;
		align-items: center;
		overflow: hidden;
	}
	img {
		width: 100%;
		height: 120%;
		object-fit: cover;
	}
	.bottom-container {
		height: 50vh;
		display: flex;
		flex-direction: column;
		align-items: center;
	}
	.signup-container {
		display: flex;
		flex-direction: column;
		gap: 1rem;
	}
	button {
		border-radius: 20px;
		height: 2rem;
		font-size: 1.1rem;
		border: solid 4px #f6ae2b;
		background-color: #f6ae2b;
	}
	button:hover{
		cursor: pointer;
	}
    #signup-firstname,
    #signup-lastname,
	#signup-email,
	#signup-password,
    #url-image {
		border: solid 2px #f6ae2b;
		border-radius: 10px;
	}
	h1 {
		color: #f6ae2b;
		padding: 0.5rem;
	}
	a {
        text-decoration: none;
        color: inherit;
    }
	input{
		outline: none;
		text-align: center;
	}
</style>
